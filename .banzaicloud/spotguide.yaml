name: 'Kafka Spotguide'
description: 'Production grade Kafka on Kubernets'
tags: ['Kafka', 'Big Data', 'Zookeeper', 'Queue']
resources:
  sumCpu: 8
  sumMem: 12
  filters: []
  sameSize: false
  onDemandPct: 25
  minNodes: 3
  maxNodes: 4
questions:
- type: pipeline
  dataType: enum
  key: kafka_version_enum
  label: 'Kafka Version'
  default: '2.12-2.1.0'
  required: true
  group: Kafka
  options:
  - '2.12-2.1.0'
  - '2.11.1.1.1'
  targets:
    - deploy_kafka.deployment.values.image.tag
- type: pipeline
  dataType: string
  label: 'Number of Kafka brokers'
  default: '3'
  group: Kafka
  targets:
    - deploy_kafka.deployment.values.brokers.replicas
- type: pipeline
  dataType: string
  label: 'Persistent Volume size'
  pattern: ^\d+(E|P|T|G|M|K|Ei|Pi|Ti|Gi|Mi|Ki)?$
  default: '10Gi'
  group: Kafka
  targets:
    - deploy_kafka.deployment.values.brokers.disk.size
- type: pipeline
  dataType: boolean
  key: sslinter
  description: Rest Proxy can only be enabled when brokers are communication via plaintext because proxy does not support SSL/SCRAM connections to brokers
  label: 'Enable SSL for inter broker communication'
  default: true
  group: Kafka
  targets: []
- type: pipeline
  dataType: boolean
  key: sslexternal
  label: 'Enable SSL for external broker communication'
  default: true
  group: Kafka
  targets: []
- type: pipeline
  dataType: boolean
  key: saslscarminter
  label: 'Enable SASL/SCRAM for inter broker communication'
  default: true
  group: Kafka
  showIf:
    properties:
        sslinter:
          const: true
  targets: []
- type: pipeline
  dataType: boolean
  label: 'Enable SASL/SCRAM for external broker communication'
  key: saslscarmexternal
  default: true
  group: Kafka
  showIf:
    properties:
        sslexternal:
          const: true
  targets: []
- type: secret
  name: auth
  dataType: password
  label: 'SASL/SCRAM auth credentials'
  group: Kafka
  showIf:
    anyOf:
    - properties:
        saslscarminter:
          const: true
    - properties:
        saslscarmexternal:
          const: true
  targets: []
- type: pipeline
  dataType: string
  controlType: code
  config:
    mode: properties
  label: 'Broker properties'
  group: Kafka
  required: false
  default: |
    default.replication.factor=3
    num.partitions=3
  targets:
   - deploy_kafka.deployment.values.brokers.config
- type: pipeline
  dataType: string
  label: 'Number of Zookeeper nodes'
  default: '3'
  group: Zookeeper
  targets:
    - deploy_zk.deployment.values.cluster.size
- type: pipeline
  dataType: boolean
  label: 'Schema Registry enabled'
  default: true
  group: Schema Registry
  targets:
    - deploy_kafka.deployment.values.banzaicloud.schemaRegistry.enabled
- type: pipeline
  dataType: string
  label: 'Zk server address'
  required: true
  default: 'zookeeper-cluster-client.zookeeper:2181'
  group: Kafka
  targets:
    - deploy_kafka.deployment.values.banzaicloud.zk.url
- type: pipeline
  dataType: boolean
  label: 'Rest Proxy enabled'
  default: true
  group: Rest Proxy
  showIf:
    properties:
      sslinter:
        const: false
  targets:
    - deploy_kafka.deployment.values.banzaicloud.restProxy.enabled
